version: '3.9'

services:
  server:
    image: ghcr.io/kevinbioj/bus-tracker-2/server:sha-${GITHUB_SHA}
    environment:
      - DATABASE_URL_FILE=/run/secrets/database_url
    secrets:
      - database_url
  
  client:
    image: ghcr.io/kevinbioj/bus-tracker-2/client:sha-${GITHUB_SHA}
    ports:
      - 3000:3000

secrets:
  database_url:
    name: bus-tracker_database-url
    external: true
